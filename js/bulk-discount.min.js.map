{"version":3,"sources":["bulk-discount.js"],"names":["$","jQuery","fn","bulk_discount","inputChange","data","$table","find","each","push","qty","this","val","ppu","$this","JSON","stringify","closest","change","rebind","off","on","remove","addRow","append","initData","parse","attr","i","length","sortable","beforeStop","disableSelection"],"mappings":"0FAAA,IAAUA,GAAAA,EAwFPC,QArFCC,GAAGC,cAAgB,WAOnB,SAASC,IACP,IAAIC,EAAO,GACXC,EAAOC,KAAK,YAAYC,KAAK,WAC3BH,EAAKI,KAAK,CACRC,IAAKV,EAAEW,MACJJ,KAAK,aACLK,MACHC,IAAKb,EAAEW,MACJJ,KAAK,aACLK,UAGPE,EAAMP,KAAK,wBAAwBK,IAAIG,KAAKC,UAAUX,IACtDC,EACGW,QAAQ,oCACRV,KAAK,mBACLW,SAGL,SAASC,IACPL,EACGP,KAAK,SACLa,IAAI,SAAUhB,GACdiB,GAAG,SAAUjB,GAEhBU,EACGP,KAAK,iBACLa,IAAI,SACJC,GAAG,QAAS,WACXrB,EAAEW,MACCM,QAAQ,MACRK,SACHlB,MAGJU,EACGP,KAAK,cACLa,IAAI,SACJC,GAAG,QAAS,WACXE,EAAO,EAAG,GACVJ,MAIN,SAASI,EAAOb,EAAKG,GACnBP,EACGC,KAAK,SACLiB,OACC,yHACEd,EACA,sDACAG,EACA,oGAMR,IAhEA,IAAIC,EAAQd,EAAEW,MACVL,EAASQ,EAAMP,KAAK,uBACpBkB,EAAWV,KAAKW,MAAMpB,EAAOqB,KAAK,cA8D7BC,EAAI,EAAGA,EAAIH,EAASI,OAAQD,IACnCL,EAAOE,EAASG,GAAGlB,IAAKe,EAASG,GAAGf,KAiBtC,OAbAP,EACGC,KAAK,SACLuB,SAAS,CACRC,WAAY,SAAAA,IACV3B,OAGH4B,mBAGHb,IACAf,IAEOU","sourcesContent":["(function($) {\n  \"use strict\";\n\n  $.fn.bulk_discount = function() {\n    var $this = $(this);\n    var $table = $this.find(\"table.bulk-discount\");\n    var initData = JSON.parse($table.attr(\"data-init\"));\n\n    //Setup functions\n\n    function inputChange() {\n      var data = [];\n      $table.find(\"tbody tr\").each(function() {\n        data.push({\n          qty: $(this)\n            .find(\"input.qty\")\n            .val(),\n          ppu: $(this)\n            .find(\"input.ppu\")\n            .val()\n        });\n      });\n      $this.find(\"input[type='hidden']\").val(JSON.stringify(data));\n      $table\n        .closest(\".woocommerce_variable_attributes\")\n        .find(\".wc_input_price\")\n        .change();\n    }\n\n    function rebind() {\n      $this\n        .find(\"input\")\n        .off(\"change\", inputChange)\n        .on(\"change\", inputChange);\n\n      $this\n        .find(\"button.remove\")\n        .off(\"click\")\n        .on(\"click\", function() {\n          $(this)\n            .closest(\"tr\")\n            .remove();\n          inputChange();\n        });\n\n      $this\n        .find(\"button.add\")\n        .off(\"click\")\n        .on(\"click\", function() {\n          addRow(0, 0);\n          rebind();\n        });\n    }\n\n    function addRow(qty, ppu) {\n      $table\n        .find(\"tbody\")\n        .append(\n          \"<tr><td><div style='width:25px;height:25px;cursor:all-scroll;'></div></td><td><input class='qty' type='number' value='\" +\n            qty +\n            \"'></td><td><input type='number' class='ppu' value='\" +\n            ppu +\n            \"'></td><td><button type='button' class='button remove' style='width: 100%;'>-</button></td></tr>\"\n        );\n    }\n\n    //Init\n\n    for (var i = 0; i < initData.length; i++) {\n      addRow(initData[i].qty, initData[i].ppu);\n    }\n\n    //Draggable rows using jquery ui\n    $table\n      .find(\"tbody\")\n      .sortable({\n        beforeStop: function() {\n          inputChange();\n        }\n      })\n      .disableSelection();\n\n    //Handlers\n    rebind();\n    inputChange();\n\n    return $this;\n  };\n})(jQuery);\n"]}