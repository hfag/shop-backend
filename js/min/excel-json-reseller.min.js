!function($){"use strict";function e(e){var a=e.target.result,n=t.read(a,{type:"binary"}),i=n.SheetNames;i.forEach(function(e){var a=t.utils.sheet_to_json(n.Sheets[e]),i=[],o,s,d,l={Adresszeile_oben:{key:"additional_line_above",required:!1},Vorname:{key:"first_name",required:!1},Name:{key:"last_name",required:!1},Firma:{key:"company",required:!1},Strasse:{key:"address_1",required:!0},Firmenbezeichnung:{key:"address_2",required:!1},Postfach:{key:"post_office_box",required:!1},PLZ:{key:"postcode",required:!0},Ort:{key:"city",required:!0},Land:{key:"country",required:!0},Telefon_Nr:{key:"phone",required:!1},Homepage:{key:"website",required:!1},"E-Mail":{key:"email",required:!0},Adress_Nr:{key:"address_number",required:!0}};for(d=0;d<a.length;d++){var p={action:"import_reseller",additional_line_above:"",first_name:"",last_name:"",company:"",address_1:"",address_2:"",post_office_box:"",postcode:"",city:"",country:"",phone:"",website:"",mail:"",address_number:"",display_name:"",discounts:{}};if("Wiederverkaeufer"in a[d]!=!1&&1===parseInt(a[d].Wiederverkaeufer,10)){for(o in l)if(l.hasOwnProperty(o))if(o in a[d]&&void 0!==typeof a[d][o]&&""!==a[d][o].trim())p[l[o].key]=a[d][o].trim();else if(l[o].required)return void alert("Column "+o+" is not present on line "+d+" but is required!");if(""!==p.company)p.display_name=p.company;else if(""!==p.first_name&&""!==p.last_name)p.display_name=p.last_name+" "+p.first_name;else if(""!==p.first_name)p.display_name=p.first_name;else{if(""===p.last_name)return void alert("There isn't enough data about the reseller on line "+d+" to generate a display name! (first name OR last name OR company name are REQUIRED)");p.display_name=p.last_name}for(s in a[d])a[d].hasOwnProperty(s)&&s.indexOf("Rabatt_")!==-1&&(p.discounts[s.replace("Rabatt_","").trim()]=parseInt(a[d][s],10));i.push(p)}}$("#log-filename").append(" Done!"),$("#import-progress").attr("value","0"),$("#import-progress").attr("max",i.length-1),r(i,0,function(){})})}function r(e,a,t){return a>=e.length?void t():($("#log-ajax").append("<p>["+(a+1)+"/"+e.length+", "+Math.round(1e4*(a+1)/e.length)/100+"%] Adding "+e[a].display_name+"...</p>"),void jQuery.post(n,e[a],function(n){$("#log-ajax p:last-child").append(" "+n.message),$("#import-progress").attr("value",a),$(window).scrollTop($(document).height()),r(e,a+1,t)}))}function a(r){r.stopPropagation(),r.preventDefault();var a=r.dataTransfer.files,n,t;for(n=0,t=a[n];n!==a.length;++n){var i=new FileReader,o=t.name;i.onload=e,$("#log-filename").append("Reading and parsing "+o+" ..."),i.readAsBinaryString(t)}}var n=window.ajaxurl,t=window.XLSX;$("#drop-excel").on("dragover",function(e){e.preventDefault(),e.stopPropagation(),$(this).addClass("dragging")}),$("#drop-excel").on("dragleave",function(e){e.preventDefault(),e.stopPropagation(),$(this).removeClass("dragging")}),document.getElementById("drop-excel").addEventListener("drop",a,!1)}(jQuery);
//# sourceMappingURL=./excel-json-reseller.min.js.map