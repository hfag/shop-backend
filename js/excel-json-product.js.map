{"version":3,"sources":["excel-json-product.ts"],"names":["logField","dropField","progressBar","downloadJSON","downloadCSV","reader","attributeMeta","name","columnKey","slug","position","visibility","variation","isTaxonomy","sort","a","b","attributeKeys","map","attribute","log","args","innerHTML","join","console","updateProgress","value","excelToJSON","workbook","sheetNameList","SheetNames","products","forEach","sheetName","XLSX","window","excelProducts","utils","sheet_to_json","Sheets","attributesPerVariation","discountsPerVariation","variationParentBySku","filter","productData","index","Math","max","length","product","sku","parent","price","categories","imageCode","minimumOrderQuantity","attributes","discountGroups","bulkDiscount","trim","Error","width","parseFloat","height","indexOf","push","parseInt","includes","split","column","discountGroup","replace","pricePerUnit","toString","quantity","ppu","qty","attributeKey","JSON","parse","stringify","e","message","productsToCSV","maxNumberOfAttributes","reduce","maxNumber","Object","keys","attributeHeader","i","csv","meta","find","type","readExcel","data","result","read","jsonDataString","encodeURIComponent","setAttribute","style","display","addEventListener","document","querySelector","preventDefault","stopPropagation","classList","add","remove","files","dataTransfer","alert","FileReader","onload","readAsBinaryString"],"mappings":"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"}